resources:
  jobs:
    IEF_sesion4:
      name: IEF_sesion4
      tasks:
        - task_key: Ingesta_aircraftV2
          spark_python_task:
            python_file: /Workspace/Users/251104javierceste@gmail.com/IEF_Course1_360degreesDatabricks/IEF_360deg_sesion4/src/01_ingesta_datos.py
            parameters:
              - --input_file=/Volumes/sesion4/layer10_landing/volume/fleet_dim_aircraft_errors.csv
              - --output_table=sesion4.layer20_bronze.dim_aircraft
              - --write_mode=overwrite
              - --partition_by=
          environment_key: Default
        - task_key: Ingesta_maintenance_event
          spark_python_task:
            python_file: /Workspace/Users/251104javierceste@gmail.com/IEF_Course1_360degreesDatabricks/IEF_360deg_sesion4/src/01_ingesta_datos.py
            parameters:
              - --input_file=/Volumes/sesion4/layer10_landing/volume/mro_fact_maintenance_event_errors.csv
              - --output_table=sesion4.layer20_bronze.fact_maintenance_event
              - --write_mode=overwrite
              - --partition_by=
          environment_key: Default
        - task_key: Ingesta_sensors
          spark_python_task:
            python_file: /Workspace/Users/251104javierceste@gmail.com/IEF_Course1_360degreesDatabricks/IEF_360deg_sesion4/src/01_ingesta_datos.py
            parameters:
              - --input_file=/Volumes/sesion4/layer10_landing/volume/ops_fact_engine_sensor_errors.csv
              - --output_table=sesion4.layer20_bronze.fact_engine_sensor
              - --write_mode=overwrite
              - --partition_by=
          environment_key: Default
        - task_key: Validacion_aircraftV2
          depends_on:
            - task_key: Ingesta_aircraftV2
          spark_python_task:
            python_file: /Workspace/Users/251104javierceste@gmail.com/IEF_Course1_360degreesDatabricks/IEF_360deg_sesion4/src/02_validacion_datos.py
            parameters:
              - --input_table=sesion4.layer20_bronze.dim_aircraft
              - --output_table=sesion4.layer30_silver.dim_aircraft
              - --config_path=/Volumes/sesion4/layer99_ops/configs/schemas_enriched.json
              - --table_name=dim_aircraft
              - --write_mode=overwrite
              - --quarantine_table=sesion4.layer30_silver_quarantine.dim_aircraft_quarantine
          environment_key: Default
        - task_key: Validacion_maintenance_events
          depends_on:
            - task_key: Ingesta_maintenance_event
          spark_python_task:
            python_file: /Workspace/Users/251104javierceste@gmail.com/IEF_Course1_360degreesDatabricks/IEF_360deg_sesion4/src/02_validacion_datos.py
            parameters:
              - --input_table=sesion4.layer20_bronze.fact_maintenance_event
              - --output_table=sesion4.layer30_silver.fact_maintenance_event
              - --config_path=/Volumes/sesion4/layer99_ops/configs/schemas_enriched.json
              - --table_name=fact_maintenance_event
              - --write_mode=overwrite
              - --quarantine_table=sesion4.layer30_silver_quarantine.fact_maintenance_event_quarantine
          environment_key: Default
        - task_key: Validacion_sensors
          depends_on:
            - task_key: Ingesta_sensors
          spark_python_task:
            python_file: /Workspace/Users/251104javierceste@gmail.com/IEF_Course1_360degreesDatabricks/IEF_360deg_sesion4/src/02_validacion_datos.py
            parameters:
              - --input_table=sesion4.layer20_bronze.fact_engine_sensor
              - --output_table=sesion4.layer30_silver.fact_engine_sensor
              - --config_path=/Volumes/sesion4/layer99_ops/configs/schemas_enriched.json
              - --table_name=fact_engine_sensor
              - --write_mode=overwrite
              - --quarantine_table=sesion4.layer30_silver_quarantine.fact_engine_sensor_quarantine
          environment_key: Default
        - task_key: Layer31_fixes_silver
          depends_on:
            - task_key: Validacion_aircraftV2
            - task_key: Validacion_maintenance_events
            - task_key: Validacion_sensors
          notebook_task:
            notebook_path: /Workspace/Users/251104javierceste@gmail.com/IEF_Course1_360degreesDatabricks/IEF_360deg_sesion4/src/03_cuarentena_recov_SOL
            source: WORKSPACE
      queue:
        enabled: true
      environments:
        - environment_key: Default
          spec:
            client: "3"
      performance_target: PERFORMANCE_OPTIMIZED
